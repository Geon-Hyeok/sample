<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.grgr.mapper.MarketBoardMapper">

	<!-- 게시판 등록 -->
	<insert id="insert">
		insert into market_board(
		MARKET_TITLE,
		MARKET_CONTENT, COST, UNO)
		values (
		#{marketTitle},
		#{marketContent}, #{cost}, #{uno})
	</insert>

	<!-- 게시판 목록 -->
	<select id="getList" resultType="com.grgr.model.MarketBoardVO">
		select * from market_board order
		by MARKET_BNO asc
	</select>

	<!-- 게시판 목록(페이징 적용) -->
	<select id="getListPaging"
		resultType="com.grgr.model.MarketBoardVO">
		<![CDATA[
		select MARKET_BNO, MARKET_TITLE, MARKET_CONTENT, UNO, COST, MARKET_REGDATE, MARKET_UPDATE
		from(
			select rownum as rn, MARKET_BNO, MARKET_TITLE, MARKET_CONTENT, UNO, COST, MARKET_REGDATE, MARKET_UPDATE
			from MARKET_BOARD
			where rownum <= #{pageNum} * #{amount}
		]]>
		<if test="keyword != null">
			and MARKET_TITLE like '%'||#{keyword}||'%'
		</if>
		<![CDATA[
			)
		where rn > (#{pageNum} - 1) * #{amount}
		]]>
	</select>

	<!-- 게시글 조회 -->
	<select id="getPage" resultType="com.grgr.model.MarketBoardVO">
		select * from MARKET_BOARD where
		MARKET_BNO = #{marketBno}
	</select>

	<!-- 게시글 수정 -->
	<update id="modify">
		update MARKET_BOARD set MARKET_TITLE =
		#{marketTitle}, MARKET_CONTENT =
		#{marketContent}, COST = #{cost}, MARKET_UPDATE =
		sysdate where MARKET_BNO = #{marketBno}
	</update>

	<!-- 게시글 삭제 -->
	<delete id="delete">
		delete from MARKET_BOARD where MARKET_BNO =
		#{marketBno}
	</delete>

	<!-- 게시물 총 갯수 -->
	<select id="getTotal" resultType="int">
		select count(*) from MARKET_BOARD
		<if test="keyword != null">
			where MARKET_TITLE like '%'||#{keyword}||'%'
		</if>
	</select>

</mapper>
